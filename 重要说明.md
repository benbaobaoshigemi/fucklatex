# ⚠️ 重要说明 - Word公式转换

## 🎉 重大更新：现已支持自动渲染！

**从版本3.1开始，程序已支持一键自动渲染功能！** 现在您可以直接将LaTeX公式转换为Word的专业格式，无需手动操作。

## 自动渲染功能

### 什么是自动渲染？
程序现在可以：
1. 将 `$...$` 包裹的LaTeX转换为Word公式对象
2. **自动渲染**为漂亮的二维专业格式
3. 批量处理文档中的所有公式

### 使用方法
运行程序后，当询问"是否自动渲染公式？(y/n)"时，输入 `y` 即可。

## 技术原理

### UnicodeMath格式
程序将LaTeX转换为Word的UnicodeMath格式：
- 使用Unicode数学符号（如 α, β, ∑, ∫）
- 采用线性表示法（如 x^2, (a)/(b)）
- 完全兼容Word原生支持

### OMML结构
插入的公式使用完整的OMML（Office Math Markup Language）结构：
```xml
<m:oMath>
    <m:r>
        <w:rPr><w:rFonts w:ascii="Cambria Math"/></w:rPr>
        <m:t>x^2</m:t>
    </m:r>
</m:oMath>
```

### 工作流程
1. 扫描文档识别 `$...$` 模式
2. 提取LaTeX字符串
3. 转换为UnicodeMath格式
4. 创建OMML元素
5. 插入到Word文档
6. **可选：自动渲染为专业格式**（新功能）

## 支持的LaTeX命令

### 基础运算
- 上标/下标：`$x^2$`, `$a_i$`, `$x_i^2$`
- 分数：`$\frac{a}{b}$`
- 根号：`$\sqrt{2}$`

### 数学符号
- 希腊字母：`\alpha`, `\beta`, `\gamma`, `\delta`, `\Gamma`, `\Delta`, `\Sigma`, `\Omega`
- 运算符：`\pm`, `\times`, `\div`
- 关系符：`\le`, `\ge`, `\ne`, `\approx`
- 特殊符号：`\infty`, `\rightarrow`, `\leftarrow`, `\Rightarrow`, `\Leftarrow`

### 高级运算
- 求和：`$\sum_{i=1}^{n} i$`
- 积分：`$\int_{0}^{1} x dx$`
- 乘积：`$\prod_{i=1}^{n} i$`

## 限制和注意事项

### 公式格式要求
1. **必须使用单个 `$` 包裹**（行内公式）
   - ✅ 正确：`$x^2$`
   - ❌ 错误：`$$x^2$$`（双美元符号不支持）

2. **LaTeX命令有限制**
   - 仅支持基本数学命令
   - 不支持复杂的LaTeX宏包
   - 不支持自定义命令

### 常见问题

**Q: 某些公式无法渲染？**
A: 可能使用了不支持的LaTeX命令，尝试简化公式或使用替代符号。

**Q: 输出文档无法打开？**
A: 确保没有同时打开输出文档，关闭Word后重新运行程序。

**Q: 中文路径问题？**
A: 程序支持中文路径，但建议使用英文路径避免潜在问题。

## 适用场景

### ✅ 推荐使用
- 学术论文转换
- 数学作业批处理
- 教材编写
- 技术文档整理
- LaTeX到Word的迁移

### ❌ 不适用场景
- 复杂的LaTeX宏包
- 多行公式环境
- 自定义LaTeX命令
- TikZ图形等高级功能

对于这些场景，建议使用专业工具如 Pandoc、MathType 或继续使用LaTeX。

## 性能指标

- 处理速度：约100-500个公式/秒（取决于复杂度）
- 支持的文档大小：无限制（受内存限制）
- 准确率：对于支持的LaTeX命令接近100%

## 版本历史

- **v3.1** (2025-10-28): 添加自动渲染功能，支持一键转换为专业格式
- **v3.0** (2025-10-27): 重构代码结构，优化公式识别算法
- **v2.0** (2025-10-26): 添加Word COM API支持
- **v1.0** (2025-10-25): 基础LaTeX转换功能

---
**版本**: 3.1 - 生产就绪版
**最后更新**: 2025年10月28日
**核心技术**: UnicodeMath + OMML + Word COM API
